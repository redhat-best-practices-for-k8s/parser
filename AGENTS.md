# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

The HTML Parser is a frontend JavaScript application that parses `claim.json` files generated by the Red Hat Best Practices Certification for Kubernetes test suite (certsuite). It displays test results in a human-readable format, allows annotation of results, and generates shareable standalone HTML pages.

**Expected claim format version:** `v0.5.0`

## Build Commands

```bash
# Install dependencies
yarn install

# Build the standalone HTML file (inlines CSS/JS into results.html)
make build

# Backup external CDN references locally
make backup-refs
```

## Linting

```bash
# JavaScript linting (StandardJS)
yarn standard html/index.js

# CSS linting (StyleLint)
yarn stylelint html/*.css
```

CI also runs HTML5 validation and typo checking on the `html/` directory.

## Architecture

```
html/
├── index.html    # Main HTML template with Red Hat Design System imports
├── index.js      # Core application logic (~1100 lines)
├── style.css     # Stylesheet with RHDS design tokens
├── build.js      # Node.js build script using inline-source
└── results.html  # Generated standalone output (built artifact)
```

**Build process:** `html/build.js` uses the `inline-source` package to inline all CSS and JavaScript into `results.html`, creating a self-contained distributable file.

### Key Components in index.js

- **Global state:** `claimGlobal` (parsed test results), `feedbackGlobal` (user annotations), `uuidNode` (tree node counter)
- **Loading modes:**
  - Manual file upload via UI buttons
  - Auto-load from `claimjson.js` and `feedback.js` files in same directory
  - URL parameters: `?claimfile=<url>&feedback=<url>`
  - Embedded JavaScript variables: `initialjson` and `feedback`
- **Core functions:** Result rendering, ANSI decoding (via AnsiUp), filtering/sorting, feedback saving, tree navigation

## Versioning

Parser version tracks claim format compatibility:
- Parser `v0.5.x` supports claim format `v0.5.0`
- Minor version = claim format version
- Patch version = parser release iteration
